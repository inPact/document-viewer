
let documentViewer = new DocumentViewer();
// let documents = [{"_id":"5c175c09b187b8bbe86c1016","requestKey":"5c16730f1dd8328ca1d03c9c_5c1672a8f5a8c87c02004a8d_undefined","organization":"59c3f78cd1ea272200200880","documentType":"orderBill","printData":{"collections":{"EXCLUSIVE_TAXES":[{"NAME":"Sales Tax","AMOUNT":0.68,"TAXABLE_AMOUNT":8.25,"RATE":8.25}],"INCLUSIVE_TAXES":[],"EXEMPTED_TAXES":[],"ORDERED_OFFERS_LIST":[{"OO_ID":"5c167294f5a8c87c02d63af9","OFFER_NAME":"Cold Brew 12oz","OFFER_AMOUNT":3,"OFFER_PRICE":3,"OFFER_CALC_AMT":3,"OFFER_QTY":1,"OFFER_COURSE":"Beverages","OFFER_UNITS":null,"OFFER_MILLI_UNITS":0,"OPEN_PRICE":false,"OFFER_TYPE":"Simple"},{"OO_ID":"5c16729cf5a8c87c02d63afb","OFFER_NAME":"Latte 16oz","OFFER_AMOUNT":5.25,"OFFER_PRICE":5.25,"OFFER_CALC_AMT":5.25,"OFFER_QTY":1,"OFFER_COURSE":"Beverages","OFFER_UNITS":null,"OFFER_MILLI_UNITS":0,"OPEN_PRICE":false,"OFFER_TYPE":"Simple"},{"OO_ID":"5c16729bf5a8c87c02d63afa","OFFER_NAME":"Latte 16oz","OFFER_AMOUNT":5.25,"OFFER_PRICE":5.25,"OFFER_CALC_AMT":5.25,"OFFER_QTY":1,"OFFER_COURSE":"Beverages","OFFER_UNITS":null,"OFFER_MILLI_UNITS":0,"OPEN_PRICE":false,"ORDERED_OFFER_DISCOUNTS":[{"DISCOUNT_AMOUNT":5.25,"DISCOUNT_NAME":"1+1"}],"OFFER_TYPE":"Simple"}],"RETURNED_OFFERS_LIST":[],"PAYMENT_LIST":[{"P_ID":"5c1672a8f5a8c87c02004a8d","P_TENDER_TYPE":"creditCard","P_NAME":"Credit","P_AMOUNT":5.46,"P_CHANGE":0,"CUSTOMER_NAME":"TEST/VANTIV","DOCUMENT_STATUS":"printed","ENTRY_METHOD":"swipe","CONFIRMATION_NUMBER":"000044","LAST_4":"4422","PROVIDER_PAYMENT_DATE":"2018-12-16T14:44:37.000Z","PROVIDER_TRANS_ID":"7834693","NUMBER":1,"TIP_AMOUNT":1,"P_AMOUNT_WO_TIP":4.46,"TIP_STATUS":"provided","CANCELED":false,"CARD_TYPE":"Mastercard","ISSUER":"Other","MERCHANT_NUMBER":"3928907","PROVIDER_RESPONSE_CODE":"0","TRANS_TYPE":"Purchase","PROVIDER_RESPONSE_MESSAGE":"AP","PROVIDER_TRANS_STATUS":"completed","EMV_FORMAT":0,"SIGNATURE_CAPTURED":true,"SIGNATURE_REQUIRED":true},{"P_ID":"5c1672ccf5a8c87c02004a98","P_TENDER_TYPE":"creditCard","P_NAME":"Credit","P_AMOUNT":6.47,"P_CHANGE":0,"CUSTOMER_NAME":"TEST/VANTIV","DOCUMENT_STATUS":"printed","ENTRY_METHOD":"swipe","CONFIRMATION_NUMBER":"000044","LAST_4":"4422","PROVIDER_PAYMENT_DATE":"2018-12-16T14:45:04.000Z","PROVIDER_TRANS_ID":"7834695","NUMBER":2,"TIP_AMOUNT":2,"P_AMOUNT_WO_TIP":4.47,"TIP_STATUS":"provided","CANCELED":false,"CARD_TYPE":"Mastercard","ISSUER":"Other","MERCHANT_NUMBER":"3928907","PROVIDER_RESPONSE_CODE":"0","TRANS_TYPE":"Purchase","PROVIDER_RESPONSE_MESSAGE":"AP","PROVIDER_TRANS_STATUS":"completed","EMV_FORMAT":0,"SIGNATURE_CAPTURED":true,"SIGNATURE_REQUIRED":true}],"ORDER_DISCOUNTS_LIST":[],"MEMBERS":[],"GUESTS":[{"CHAIR_NUMBER":1,"TOTAL_AMOUNT":0,"ITEM_LIST":[{"DISH_NAME":"Cold Brew","ITEM_QTY":1,"ITEM_AMOUNT":0,"ON_THE_HOUSE":"1"},{"DISH_NAME":"Latte 1234567890","ITEM_QTY":1,"ITEM_AMOUNT":0,"ON_THE_HOUSE":"1"},{"DISH_NAME":"Latte 1234567890","ITEM_QTY":1,"ITEM_AMOUNT":0,"ON_THE_HOUSE":"1"}]}],"TIPS":[]},"variables":{"PRINT_TYPE":"BY_TABLE","BASIC_WEIGHT_UOM":"kg","ORGANIZATION_NAME":"LAYERED","ORGANIZATION_LEGAL_NAME":"Layered","ORGANIZATION_BN_NUMBER":"123","ORGANIZATION_TEL":"(972) 542-6317","ORGANIZATION_ADDR_STREET":"111 E. Virginia","ORGANIZATION_ADDR_CITY":"McKinney, TX","ORGANIZATION_ADDR_ZIP":"75069","TABLE_NO":1001,"ORDER_NO":239,"F_NAME":"Maayan","L_NAME":"M","RETURN_TYPE":"","ORDER_TYPE":"SEATED","FINAL":"1","W_ID":0,"CREATED_AT":"2018-12-16T15:43:12.454Z","TOTAL_SALES_AMOUNT":8.25,"TOTAL_IN_VAT":8.25,"TOTAL_EX_VAT":8.25,"BAL_DUE":0,"CHANGE":0,"VAT_AMOUNT":0,"VAT_PERCENT":0,"TOTAL_PAYMENTS":11.93,"TOTAL_ROUNDING":0,"TOTAL_AMOUNT":11.93,"TOTAL_CASH_AMOUNT":0,"TEMP_VAR_PRINT_CREDIT_SIGNATURE_SLIP":true,"TEMP_VAR_PRINT_HAKAFA_SIGNATURE_SLIP":true,"TEMP_VAR_GENERAL1":true,"TEMP_VAR_GENERAL2":true,"TEMP_VAR_GENERAL3":true,"TEMP_VAR_GENERAL4":true,"TEMP_VAR_GENERAL5":true,"TOTAL_TIPS":3,"TOTAL_TIPS_ON_PAYMENTS":3,"TOTAL_TIPS_ON_ORDER":0,"NUMBER_OF_GUESTS":1,"TOTAL_ORDER_DISCOUNTS":0,"TOTAL_ITEM_DISCOUNTS":5.25,"TOTAL_DISCOUNTS":5.25,"ORDER_ON_THE_HOUSE":"0","CLOSED_AT":"2018-12-16T15:45:19.973Z","TOTAL_EXCLUDED_TAX":0.68,"TOTAL_INCLUDED_TAX":0,"TOTAL_BEFORE_EXCLUDED_TAX":8.25,"TOTAL_AFTER_EXCLUDED_TAX":8.93,"DETAILED_EXCLUDED_TAX_SUMMARY":true}},"created":"2018-12-17T08:19:21.263Z","lastUpdated":"2018-12-17T08:19:21.263Z","__v":0}];
let creditSlip = generateCreditSlip(documents, documents[0].printData.collections.PAYMENT_LIST[0].P_ID);

let element = document.createElement('div');
element.id = 'MainElement';
element.style.width = '400px';
element.style.direction = 'rtl';

let html = documentViewer.getDocumentHtml(creditSlip);

element.insertAdjacentHTML('beforeend', html);
document.body.appendChild(element);

function generateCreditSlip(documents, paymentId) {
    let orderBill = _.cloneDeep(documents.find(document => document.documentType === 'orderBill'));
    if (!orderBill)
        return;

    orderBill.printData.collections.PAYMENT_LIST
        = orderBill.printData.collections.PAYMENT_LIST.filter(paymentEntry => paymentEntry.P_ID === paymentId);

    return {
        documentType: 'creditSlip',
        printData: orderBill.printData
    };
}

